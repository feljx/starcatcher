!function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){const s=n(5),r=class{constructor(e,t){this.container=this.c=e,this.children=t,this.state=this.s={}}clear(){for(const e of this.children)this.clearView(e)}render(){for(const e of this.children)this.clearView(e),this.renderView(e)}clearView(e){this.s[e.name]&&(this.s[e.name].remove(),this.s[e.name]=void 0)}renderView(e){this.clearView(e);const t=e();this.container.appendChild(t),this.s[e.name]=t}};e.exports.Context=r,e.exports.RenderingContext=r;const i=e=>document.createElement(e);e.exports.el=i;const o=(e,t)=>{if(!t)throw new Error('"styles" object must be defined');const n=document.createElement(e);return n.className=s(t),n};e.exports.styled=o;e.exports.add_class=(e,t)=>e.className+=` ${t}`;e.exports.remove_class=(e,t)=>e.className=e.className.replace(t,"");e.exports.style=(e,t)=>{""===e.className?e.className+=s(t):e.className+=" "+s(t)};e.exports.restyle=(e,t)=>{e.className=s(t)};e.exports.add_text=(e,t)=>e.appendChild(document.createTextNode(t));e.exports.remove_text=(e,t)=>{e&&("string"==typeof t?e.textContent=e.textContent.replace(t,""):t&&3===t.nodeType?e.removeChild(t):e.textContent=void 0)};e.exports.div=e=>(e?o:i)("div",e);e.exports.span=e=>(e?o:i)("span",e);e.exports.h1=e=>(e?o:i)("h1",e);e.exports.h2=e=>(e?o:i)("h2",e);e.exports.p=e=>(e?o:i)("p",e);e.exports.input=e=>(e?o:i)("input",e);e.exports.button=e=>(e?o:i)("button",e)},function(e,t,n){"use strict";n.r(t),n.d(t,"STARRYFIRE",function(){return s}),n.d(t,"STARRYGOLD",function(){return r}),n.d(t,"STARRYNIGHT",function(){return i}),n.d(t,"CELL_SIZE",function(){return o}),n.d(t,"ZOOMED_FONT_SIZE",function(){return a}),n.d(t,"body_styles",function(){return c}),n.d(t,"title_styles",function(){return d}),n.d(t,"game_styles",function(){return u}),n.d(t,"sidebar_styles",function(){return h}),n.d(t,"smile_styles",function(){return f}),n.d(t,"grid_styles",function(){return p}),n.d(t,"cell_styles",function(){return m}),n.d(t,"open_cell_styles",function(){return _}),n.d(t,"flagged_cell_styles",function(){return g});const s="#b50060",r="#efde73",i="#1d2856",o=2..toString()+"rem",a=3..toString()+"rem",l={width:o,height:o,fontSize:"1.8rem",fontFamily:"Arial",fontWeight:"bold",textAlign:"center",cursor:"pointer","-ms-user-select":"none","-moz-user-select":"none","-webkit-user-select":"none",userSelect:"none"},c={backgroundColor:i,fontFamily:"Times, serif",display:"flex",flexDirection:"column",alignItems:"center",alignContent:"flex-start","> *":{marginTop:"1rem"}},d={color:r,fontSize:"4rem",marginTop:"2rem"},u={color:r,display:"flex",marginLeft:"-8rem"},h={fontSize:"2.4rem",fontFamily:"Helvetica",display:"flex",flexDirection:"column",marginRight:"4rem","> *":{padding:"0.6rem"},"> *:not(:first-child)":{marginTop:"3rem"}},f={padding:"0.6rem",cursor:"pointer",":hover":{background:r,color:i}},p={color:r,display:"grid",gridGap:"0.3rem",gridTemplateColumns:"repeat(15, 1fr)",gridTemplateColumns:"repeat(15, 1fr)"},m={...l,background:r,color:i,":hover":{color:r,background:s}},_={...l,background:i,color:r},g={...l,background:s,color:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(6),i=n(1),o=n(7);t.STAR="*",t.FLAG="#";const a=e=>{const t=e.target.field;t instanceof r.default&&t.handle_click(e.button)};t.default=class{constructor(e,t,n){this.cols=e,this.rows=t,this.prob=n,this.stars_left=0,this.fields_left=0,this.game_over=!1,this.container=s.div(i.game_styles),this.grid=s.div(i.grid_styles),this.create_board(),this.solve_board(),this.sidebar=new o.default(this),this.container.appendChild(this.sidebar.container),this.container.appendChild(this.grid),this.container.oncontextmenu=e=>e.preventDefault(),this.grid.addEventListener("mousedown",a),this.end=new Promise(e=>{this.resolve_game=e})}create_board(){this.board=Array.from({length:this.cols*this.rows},(e,n)=>{const s=this.xy(n),i=Math.random()<this.prob,o=i?t.STAR:void 0;i?++this.stars_left:++this.fields_left;const a=new r.default(this,s,o);return this.grid.appendChild(a.container),a})}xy(e){return[e%this.cols+1,Math.trunc(e/this.cols)+1]}solve_board(){for(const e of this.board){if(e.is_star)continue;const t=this.nearby(e).filter(e=>e.is_star).length;t>0&&(e.val=t.toString())}}get_field(e,t){if(e<1||t<1)return;if(e>this.cols||t>this.rows)return;const n=--e+--t*this.cols;return this.board[n]}open_field(e){if(!e.is_flagged)if(e.is_star)this.end_game(!1),e.open();else{let t=[e];for(;t.length>0;){const e=t.pop();if(!e.is_open&&(e.open(),e.is_empty)){const n=this.nearby(e);t.push(...n)}}}}nearby(e){const[t,n]=e.pos,s=[];for(let e=0;e<9;++e)if(4!==e){const r=this.get_field(t-1+Math.trunc(e/3),n-1+e%3);r&&s.push(r)}return s}end_game(e){this.game_over=!0,e?this.sidebar.brighten_smile():this.sidebar.sadden_smile(),this.grid.removeEventListener("mousedown",a),this.resolve_game(e)}},document.addEventListener("keydown",e=>{if("KeyF"===e.code){const e=document.querySelectorAll(":hover"),t=e[e.length-1];t.field instanceof r.default&&(t.field.game.game_over||t.field.flag())}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(4),r=n(0),i=n(1),o=n(2);r.style(document.body,i.body_styles);const a=r.h1(i.title_styles);r.add_text(a,"starcatcher"),s.default(a).to(document.body);let l;const c=()=>{(l=new o.default(15,15,.15)).sidebar.attach_smile_click(()=>{l.container.remove(),c()}),document.body.appendChild(l.container)};c()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(...e){return{to:function(t){const n=t;for(const t of e){const e=t instanceof HTMLElement?t:t.container;(n instanceof HTMLElement?n:n.container).appendChild(e)}}}}},function(e,t,n){"use strict";var s={},r="x",i=[],o=function(e){return i.push(e)};if(e.exports=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e){return function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments[2];return Object.keys(t).map(function(l){var c=t[l];if(null===c)return"";if("object"==typeof c){var d=/^@/.test(l)?l:null;return e(c,d?n:n+l,d||a)}var u=l+c+n+a;if(s[u])return s[u];var h=r+i.length.toString(36);return o(function(e,t){return t?t+"{"+e+"}":e}(function(e,t,n){return"."+e+"{"+t.replace(/[A-Z]|^ms/g,"-$&").toLowerCase()+":"+n+"}"}(h+n.replace(/&/g,""),l,c),a)),s[u]=h,h}).join(" ")}(e)}).join(" ").trim()},e.exports.css=function(){return i.sort().join("")},e.exports.reset=function(){for(s={};i.length;)i.pop()},e.exports.prefix=function(e){return r=e},"undefined"!=typeof document){var a=document.head.appendChild(document.createElement("style")).sheet;o=function(e){i.push(e),a.insertRule(e,a.cssRules.length)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(2),i=n(1);t.default=class{constructor(e,t,n){this.game=e,this.pos=t,this.val=n,this.container=s.span(i.cell_styles),this.is_flagged=!1,this.is_open=!1,this.container.field=this}get is_star(){return this.val===r.STAR}get is_empty(){return void 0===this.val}get has_nearby_stars(){return!isNaN(Number(this.val))}flag(){this.is_open||(this.is_flagged?(s.restyle(this.container,i.cell_styles),s.remove_text(this.container)):(s.restyle(this.container,i.flagged_cell_styles),s.add_text(this.container,r.FLAG)),this.is_flagged=!this.is_flagged)}open(){this.is_open||this.is_flagged||(s.restyle(this.container,i.open_cell_styles),this.is_open=!0,--this.game.fields_left,this.game.sidebar.update_counter(),this.is_empty||(s.add_text(this.container,this.val),this.is_star&&(this.container.style.background=i.STARRYFIRE,this.container.style.color=i.STARRYNIGHT,this.container.style.fontSize=i.ZOOMED_FONT_SIZE)),0===this.game.fields_left&&this.game.end_game(!0))}safe_reveal(){const e=this.game.nearby(this);if(e.filter(e=>e.is_flagged).length===Number(this.val))for(const t of e)this.game.open_field(t)}handle_click(e){this.is_open&&this.has_nearby_stars?this.safe_reveal():(0===e&&this.game.open_field(this),2===e&&this.flag())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),r=n(1);t.default=class{constructor(e){this.game=e,this.container=s.div(r.sidebar_styles),this.smile=s.div(r.smile_styles),this.star_counter=s.div(),s.add_text(this.smile,"; >"),this.update_counter(),this.container.appendChild(this.smile),this.container.appendChild(this.star_counter)}attach_smile_click(e){this.smile.addEventListener("click",t=>{e()})}brighten_smile(){s.remove_text(this.smile),s.add_text(this.smile,"<3")}sadden_smile(){s.remove_text(this.smile),s.add_text(this.smile,": <")}update_counter(){s.remove_text(this.star_counter),s.add_text(this.star_counter,this.game.stars_left.toString())}}}]);